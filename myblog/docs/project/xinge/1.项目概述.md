# 项目概述

[**蓝湖设计稿**](https://lanhuapp.com/url/ZKrGu-N3UoD)

[**前端代码**](https://gitee.com/what_and/xinge)

[**后端代码**](https://gitee.com/what_and/xinge-backend)

[**接口文档**](https://pan.baidu.com/s/1Vq5W76RTw44WHcQmXeJIFA) 提取码：hcjv

[**项目安卓版下载**](https://pan.baidu.com/s/1st6F6R7F71Ho-phqgKZhZA) 提取码：hcjv

## 前言
&emsp;&emsp;从辞职到学习前端不知不觉就快半年了，每次感觉时间飞逝的时候要不是在看小说，看电影，或者就是在打游戏。而计算机让我再次感觉到了这种时间飞逝的感觉，我很庆幸在我年轻的时候遇到了计算机，在两年对未来方向的模糊中，终于走了出来，找到了自己应该追寻的答案。  

&emsp;&emsp;从半年前最开始信心百倍的学习，到中途的几次不知该学习哪些知识的迷茫，在到现在能完整从原型图设计到前后端代码编写，以及打包上线之后的莫名喜悦，带给了我犹如品菜时酸甜苦辣的感受。  

&emsp;&emsp;虽然这个自己设计的小项目我完成的比较残缺，很多最初设想，规划的功能还没有实现，但我决定不再继续了。因为第一次尝试这样进行完整的流程，导致中间写的一些功能，最开始没有想到，但写到后面发现前面的一些逻辑需要修改，这样就会大大消耗时间。这个项目最初我以为十天能完成，结果现在已经进行了两个星期，这两天我犹豫着是否要重构之前的代码，因为着实写的比较乱，但想了想，这样可能又会花费很多天。所以我还是就这样暂时结束这个项目，然后抓紧时间巩固一些基础知识和背面试题。

## 项目构思

&emsp;&emsp;我想过做那种关于看小说的app，但分析后觉得这种类型的数据量会很大，所以排除这类项目。后面无意间使用微信和QQ时，想到要不就做个即时通讯的小项目，并且也可以学习学习 <font color="#FA8072">H5</font> 的新技术 <font color="#FA8072">WebSocket</font> 。 由于之前做过了H5端，也尝试过了小程序端，所以最终思考后敲定选择用 <font color="#FA8072">uni-app</font> 做一款即时通讯的小项目，这样既可以了解了解 <font color="#FA8072">uni-app</font> 的生态,并且又可以尝试发布到多端。  

### UI设计
&emsp;&emsp;其实从开始构思时，我就感觉到了对于目前的我来说，这是一个挑战。为了准备从零完成这个项目，我花了一百元在淘宝买了一个 <font color="#FA8072">UI</font> 的课程。通过5天对 <font color="#FA8072">UI</font> 初步的了解，勉强能够设计简单的原型图和 <font color="#FA8072">UI</font>  设计图。对于原型图设计，我采用的是 <font color="#FA8072">Axure RP 8</font> 这款软件。设计图我采用的是  <font color="#FA8072">PS 2019</font>,画图标我使用的是 <font color="#FA8072">AI 2019</font>。设计完成之后我上传到蓝湖，以便后期开发。  

### 前端
&emsp;&emsp;前端采用的框架是 <font color="#FA8072">uni-app</font>。由于之前做的两个小项目刚好是用 <font color="#FA8072">vue.js </font> 和微信小程序原生开发，所以这次就大概浏览了一些文档，就直接开始开发。我的页面结构目录如下：
```js
-screen     
    screen.vue          //闪屏图，静态页面
-login
    login.vue           //登录页面，采用邮箱和密码的登录方式
    signIn.vue          //注册页面，采用用户名，邮箱，密码的注册方式
-home
    home.vue            //首页
    search.vue          //搜索用户页
    addFriend.vue       //添加用户为好友页
    message.vue         //发消息页
-list
    list.vue            //通讯录
    apply.vue           //用户申请添加好友列表
    detail.vue          //是否同意添加页
-friends
    friends.vue         //朋友圈页
-set
    set.vue             //设置个人信息页
    alterName.vue       //修改用户名页
    alterSign.vue       //修改个性签名页
```

### 后端
&emsp;&emsp;后端我采用的是基于 <font color="#FA8072">Node.js</font> 平台的  <font color="#FA8072">Web</font> 开发框架 <font color="#FA8072">Express</font>。对于后端我是畏惧的，而这个框架刚好满足了我简单方便，快速上手的需求。对于构建整体的项目结构目录，最开始我也是被弄的焦头烂额，不过大概分划之后，我觉得还是比较清晰。后端结构目录如下：
```js
xinge.js            //入口文件
-router
    router.js       //路由
    file.js         //上传文件路由
-trim
    trimData.js     //整理前端发送请求的数据
    jwt.js          //token验证
    bcryptjs.js     //用户个人信息加密
    mkdir.js        //自动创建文件存储目录
    socket.js       //前后端双向通讯
-files              //保存前端需保存的数据文件夹
-controllers
    db.js           //连接数据库
    sendEmail.js    //邮件发送
-model
    dbmodel.js      //定义schema
-dbCRDU
    users.js        //用户信息表
    fiendList.js    //用户关系表
    messages.js     //一对一消息表
```

### 数据库
&emsp;&emsp;数据库我选择的是 <font color="#FA8072">MongoDB</font>，然后采用对象模型工具<font color="#FA8072">Mongoose</font>来操作数据库。原因还是简单，便捷，对于我的项目需求，学习成本较低。这个项目我定义了三个<font color="#FA8072">schema</font>，如下：

```js
let userSchema = mongoose.Schema({
    id:Schema.Types.ObjectId,                           //用户id
    imgUrl: {type: String,default: ''},                 //头像
    username: String,                                   //用户名
    email: String,                                      //邮箱
    sex: {type: String, default: ''},                   //性别
    birthDay: {type: String, default: '1997-07-28'},    //生日
    signature: {type: String, default: ''},             //签名
    password: String,                                   //密码
    signTime: Date                                      //注册时间
  }); 

let friendListSchema = mongoose.Schema({
  id:Schema.Types.ObjectId,                             //id
  userId : {type: Schema.Types.ObjectId,ref: 'users'},  //用户id
  meId: {type: Schema.Types.ObjectId,ref: 'users'},     //自己的id
  remark: String,                                       //发送好友请求的备注
  friendStatus: Number,                                 //与用户的状态
  time: Date                                            //发送请求的时间
  }); 

let MessageSchema = new Schema({
  userId : {type: Schema.Types.ObjectId,ref: 'users'},  //用户Id
  id: {type: Schema.Types.ObjectId,ref: 'users'},       //自己的id
  img: String,                                          //头像
  message: String,                                      //消息
  type: Number,                                         //消息类型
  tip: Number,                                          //消息编号
  state: Number,                                        //是否已读
  time: Date                                            //发送消息的时间
})
```