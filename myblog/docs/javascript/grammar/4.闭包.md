# 闭包
闭包是什么，有许多的定义，也有许多的答案。这些答案的用词可能不同，但表达的意思是八九不离十的，我在想为什么业界没有对闭包的一个统一的解释呢。或许我认为这种现象正好映射了道德经中一句话:
> ‘道可道，非常道 。名可名，非常名’

1. 在《《Head First JavaScript程序设计》》中，对闭包的解释是：包含 <font color="#3EAF7C">**自由变量**</font> 的函数与为所有这些自由变量提供了 <font color="#3EAF7C">**变量绑定的环境**</font> 一起，被称为闭包。要理解这句话，就必须要理解自由变量：   
自由变量：函数通常包括 <font color="#000000">**局部变量**</font> (它们在函数体中定义的，包括所有的形参)，还可能包含 <font color="#000000">**不是在本地定义的变量**</font>，这些变量就被称为自由变量。  

2. 在 《《你不知道的JavaScript》》中，对闭包的解释是：当函数可以记住并访问所在的 <font color="#3EAF7C">**词法作用域**</font> 时，就产生了闭包。

3. 在《《JavaScript高级程序设计》》中，对闭包的解释是：闭包是指有权访问另一个函数作用域中的变量的函数。

我同时也看了网上许多对闭包的解释，但看了这么多，我觉得闭包是什么，哪种定义才是对闭包最好的解释，对于现在的我来说并不重要。这些观点对应到闭包的表现形式及其作用，都是相同的。如果是闭包，那么当前执行上下文不会被立刻销毁，因此闭包达到保存的作用。执行上下文不销毁是因为避免造成冲突，因此闭包还达到了保护的作用。

用一道经典的for循环中的闭包问题来举例：
```js
<ul>
	<li>a</li>
	<li>b</li>
	<li>c</li>
</ul>
<script>
let oli = document.getElementsByTagName('li');
for(var i = 0; i < oli.length; i++){
	oli[i].onclick = function(){
		console.log(i);
	}
}
</script>
```
上面的代码，毫无疑问，无论点击哪个 <font color="#FA8072">li</font> 最终的结果都是3。这是因为，当执行方法，形成一个私有栈内存，遇到变量 <font color="#FA8072">i</font>,<font color="#FA8072">i</font> 是自由变量，通过作用域查找机制，向上级作用域查找(上级作用域window)  
当点击 <font color="#FA8072">li</font> 的时候，外层循环已经结束(点击li的时候页面已经加载完毕，页面加载完成预示着js代码都已经执行完成)，外层循环结束已经让全局下的 <font color="#FA8072">i</font> 等于 <font color="#FA8072">li</font> 的总长度

对于这个问题的解决方法有很多，这里用闭包来解决:
```js
let oli = document.getElementsByTagName('li');
for(var i = 0; i < oli.length; i++){
    (function(i){
	oli[i].onclick = function(){
		console.log(i);
    }
   })(i)
}
```
最后来一个脑筋急转弯结束闭包这个话题：
<a data-fancybox title="image" href="/blog/assets/img/bibao.36c36ec5.jpg">![image](./imgs/bibao.jpg)</a>

